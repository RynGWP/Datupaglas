<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Monthly Reports</title>

  <link rel="icon" href="/dist/img/LOGO.png" sizes="16x16" type="image/png">
  <link rel="icon" href="/dist/img/LOGO.png" sizes="32x32" type="image/png">
  <link rel="icon" href="/dist/img/LOGO.png" sizes="48x48" type="image/png">
  <link rel="icon" href="/dist/img/LOGO.png" sizes="64x64" type="image/png">
  <link rel="icon" href="/dist/img/LOGO.png" sizes="192x192" type="image/png">
  <link rel="icon" href="/dist/img/LOGO.png" sizes="512x512" type="image/png">
  
  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css">
   <!-- Bootstrap Icons CSS -->
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <!-- DataTables -->
  <link rel="stylesheet" href="/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="/plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
  <link rel="stylesheet" href="/plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
  <!-- SweetAlert2 -->
  <link rel="stylesheet" href="/plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css">
  <!-- Toastr -->
  <link rel="stylesheet" href="/plugins/toastr/toastr.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="/dist/css/adminlte.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    h1{
        font-family: 'Poppins', sans-serif;
      }
    th{
        font-size: 1rem;
        text-align: center;
        background-color: #344e41!important;
        color: #f2e9e4 !important ;
        font-weight:500 !important;
        border: .5px solid rgb(90, 85, 85) !important; 
    }

    label, .dataTables_info{
        margin-left:10px;
    }



    .table-wrapper {
            overflow-x: auto;
            max-width: 100%;
            margin: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        table {
            border-collapse: collapse;
            width: 100%;
            min-width: max-content;
            background: white;
        }

        th, td {
            padding: 12px 15px;
            text-align: center;
            border: 1px solid #ddd;
        }

        th {
            background-color: #14b8a6;
            color: white;
            font-weight: 500;
            text-transform: uppercase;
            font-size: 14px;
        }

        .barangay-col {
            position: sticky;
            left: 0;
            background: white;
            font-weight: 500;
            z-index: 1;
        }

        tr:nth-child(even) {
            background-color: #f8f8f8;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .vaccine-group {
            border-right: 2px solid #0d9488;
        }

        .total-row {
            font-weight: bold;
            background-color: #e5e7eb !important;
        }

        @media print {
            .table-wrapper {
                margin: 0;
                box-shadow: none;
            }
            
            th {
                background-color: #e5e7eb !important;
                color: black !important;
            }
        }



        .swal2-toast {
  display: flex !important; 
  align-items: center !important; 
  justify-content: center !important; 
  background-color: rgba(6, 6, 37, 0.70) !important; 
  border-radius: 2px !important; 
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1) !important; 
  backdrop-filter: blur(4px) saturate(180%) !important; 
  -webkit-backdrop-filter: blur(2px) saturate(180%) !important; 
  border: 1px solid rgba(94, 103, 146, 0.3) !important; 
  font-size: 0.7rem !important;
  width: auto !important; /* Allow width to adjust dynamically */
  max-width: 300px !important; /* Set a max-width to control toast size */
  padding: 0px 15px !important; /* Add padding for better readability */
  height: auto !important; /* Allow height to adjust dynamically */
  white-space: nowrap !important; /* Prevent text from wrapping */
}

  
  .swal2-timer-progress-bar {
    background-color: #a8afc9 !important; /* Custom color (Orange) */
    height: 4px !important; /* Set height of the progress bar */
  }
  
  .glassmorphism-popup {
  background-color: rgba(6, 6, 37, 0.70);
  border-radius: 16px;
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(4px) saturate(180%);
  -webkit-backdrop-filter: blur(2px) saturate(180%);
  border: 1px solid rgba(94, 103, 146, 0.3);
  width:450px;
  }
  
  .swal2-error {
    border-color:#FF0000 !important;
  
  }
  
  div.swal2-icon.swal2-error.swal2-icon-show > span > span.swal2-x-mark-line-left{
    background-color: red;
  }
  div.swal2-icon.swal2-error.swal2-icon-show > span > span.swal2-x-mark-line-right{
    background-color: red;
  }
  
  div.swal2-icon.swal2-success.swal2-icon-show > span.swal2-success-line-tip {
    background-color: #00FF00;
  }
  div.swal2-icon.swal2-success.swal2-icon-show > span.swal2-success-line-long {
    background-color: #00FF00;
  }
  
  div.swal2-icon.swal2-success.swal2-icon-show > div.swal2-success-circular-line-left{
    opacity:0;
     }
  div.swal2-icon.swal2-success.swal2-icon-show > div.swal2-success-circular-line-right{
    opacity:0;
     }
    
  div.swal2-icon.swal2-success.swal2-icon-show > div.swal2-success-fix{
    opacity:0;
     }
  
  .swal2-warning{
    border-color:#ff8f00 !important;
  }
  
  .swal2-success-ring{
    border-color: #00FF00 !important;
  }
  
  .swal2-title {
    font-size: 1.3rem !important; /* Smaller title font size */
    color: white !important;
    font-weight: 900;
  }
  
  .swal2-html-container {
    font-size: 1rem !important; /* Reduce font size */
    color: rgb(255, 255, 255) !important;
    font-weight: 900;
    padding:20px 10px !important;
  }
  
  .swal2-actions {
    margin-top: 10px; /* Reduce margin between text and buttons */
  }
  
  .swal2-styled.swal2-confirm {
    padding: 8px 20px; /* Smaller button padding */
    font-size: 14px !important; /* Smaller button text */
    color: white;
    font-weight: 800;
  }
  
  .swal2-styled.swal2-cancel {
    padding: 8px 20px; /* Smaller button padding */
    font-size: 14px !important; /* Smaller button text */
    color: white;
    font-weight: 800;
  }
  
  button.swal2-confirm{
    width:93px;
    background-color: #12be12c1 !important;
  }


  /* ----------------------------User Patients Edit modal buttons ------------------------------ */
#editPatientForm > div.d-flex.justify-content-end > button.btn.btn-success {
    background: #0dc00d !important;
    color: white;
    font-weight: bold;
    font-size: 1rem;
  }
  
  #editPatientForm > div.d-flex.justify-content-end > button.btn.btn-danger{
    background:#ff0000 !important;
    color:white;
    font-weight: bold;
    font-size: 1rem;
    margin-left:10px;
  }

  
/*---------------------------- Modal Footer ------------------------*/
.modal-footer{
    border:none;
  }
  /* --------------------------- Reduce modal transition duration -------------------*/
  .modal.fade .modal-dialog {
    transition: transform 0.1s ease-out;  /* Reduce the transition time to 0.1s */
  }
  .modal.fade {
    transition: opacity 0.1s linear;      /* Reduce opacity transition to 0.1s */
  }

    /*--------------------------- Modal Container---------------------------- */

    .modal {
        --bs-modal-bg:white;
        backdrop-filter: blur(10px) saturate(50%);
        -webkit-backdrop-filter: blur(10px) saturate(50%);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.125);
        transition: background 0.8s, color 0.8s;
      }

      
  .modal-content{
    background-color:#ffffff;
    border-radius: 7px;
    
    border: 1px solid rgba(94, 103, 146, 0.3);
  }

  .modal-body{
    padding:0;
  }


  </style>
</head>
<body class="hold-transition sidebar-mini">
<div class="wrapper container-fluid px-0">
  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light container-fluid" style="background-color: #125635; margin-left: 0; ">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link text-light" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="/userDashboard" class="nav-link text-light">Home</a>
      </li>

    </ul>

    <ul class="navbar-nav ml-auto ">
      <li class="nav-item">
        <a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#" role="button">

        </a>
      </li>
    </ul>

    <%- include('../partials/profile.ejs') %>
  </nav>
  <!-- /.navbar -->


  <!-- Content Header (Page header) -->
  <section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6 d-flex justify-content-between">
          <h1 class="shine">  Historical Reports</h1>
          <form action="/historicalReports" method="GET">

            <select name="year">
                <% years.forEach(function(year) { %>
                    <option value="<%= year %>"
                            <%= selectedYear === year ? 'selected' : '' %>>
                        <%= year %>
                    </option>
                <% }); %>

            </select>

            <button type="submit">Filter Reports <i class="bi bi-funnel"></i></button>
        </form>
        <button id="exportExcelButton" class="btn btn-success">Export to Excel</button>

      </div>
    </div><!-- /.container-fluid -->
  </section>


<%- include('../partials/preloader.ejs') %>
    <!-- Main content -->
    <section class="content" id="content">
      <div class="container-fluid ">
        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-body  table-responsive">
                <div class="table-responsive">
                  <table id="approvedPatientsTable" class="table table-bordered ">
                    <thead>
                      <tr>
                          <th >Barangay</th>                        
                          <th >Date</th>                        
                          <th >Eligible Population</th>                        
                          <th colspan="2">BCG</th>
                          <th colspan="2">Hepatitis B</th>
                          <th colspan="2">Pentavalent Vaccine 1</th>
                          <th colspan="2">Pentavalent Vaccine 2</th>
                          <th colspan="2">Pentavalent Vaccine 3</th>
                          <th colspan="2">OPV 1</th>
                          <th colspan="2">OPV 2</th>
                          <th colspan="2">OPV 3</th>
                          <th colspan="2">IPV</th>
                          <th colspan="2">PCV 1</th>
                          <th colspan="2">PCV 2</th>
                          <th colspan="2">PCV 3</th>
                          <th colspan="2">MMR 1</th>
                          <th colspan="2">MMR 2</th>
                          <th colspan="2">FIC</th>
                          <th colspan="2">CIC</th>
                          <th colspan="2">ACTION</th>
                      </tr>
                        
                      <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th>Male</th>
                        <th>Female</th>
                        <th></th>
                      </tr>
  
                  </thead>
                  <tbody>
                    
                    <% if (locals.reports && locals.reports.length > 0) { %> 
                      <% reports.forEach(function(report) { %>
                      <tr>
                        <td><%= report.barangay %></td>
                        <td><%= new Date(report.date_submitted).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %></td>
                        <td><%= report.total_eligible_population %></td>
                        <td><%= report.bcg_male %></td>
                        <td><%= report.bcg_female %></td>
                        <td><%= report.hepatitisb_male %></td>
                        <td><%= report.hepatitisb_female %></td>
                        <td><%= report.pentavalent1_male %></td>
                        <td><%= report.pentavalent1_female %></td>
                        <td><%= report.pentavalent2_male %></td>
                        <td><%= report.pentavalent2_female %></td>
                        <td><%= report.pentavalent3_male %></td>
                        <td><%= report.pentavalent3_female %></td>
                        <td><%= report.opv1_male %></td>
                        <td><%= report.opv1_female %></td>
                        <td><%= report.opv2_male %></td>
                        <td><%= report.opv2_female %></td>
                        <td><%= report.opv3_male %></td>
                        <td><%= report.opv3_female %></td>
                        <td><%= report.ipv_male %></td>
                        <td><%= report.ipv_female %></td>
                        <td><%= report.pcv1_male %></td>
                        <td><%= report.pcv1_female %></td>
                        <td><%= report.pcv2_male %></td>
                        <td><%= report.pcv2_female %></td>
                        <td><%= report.pcv3_male %></td>
                        <td><%= report.pcv3_female %></td>
                        <td><%= report.mmr1_male %></td>
                        <td><%= report.mmr1_female %></td>
                        <td><%= report.mmr2_male %></td>
                        <td><%= report.mmr2_female %></td>
                        <td><%= report.fic_male %></td>
                        <td><%= report.fic_female %></td>
                        <td><%= report.cic_male %></td>
                        <td><%= report.cic_female %></td>

                      <td>
                        <form action="/reports/delete" method="post"> <!-- Include method explicitly if needed -->
                          <input type="hidden" name="date" value="<%= new Date(report.date_submitted).getFullYear() %>/<%= String(new Date(report.date_submitted).getMonth() + 1).padStart(2, '0') %>/<%= String(new Date(report.date_submitted).getDate()).padStart(2, '0') %>
                          ">
                          <input type="hidden" name="barangay" value="<%= report.barangay %>">
                          <button type="submit" class="btn btn-danger btn-sm deleteButton">DELETE</button>
                      </form>
                      </td>
                        
                        
                      </tr>
                      <% }); %>
                      <% } %>
                  </tbody>
                    </table>
                </div>
                  

                <!-- ./Table -->
              </div>
              <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->

      


      <!-- /.container-fluid -->
    </section>
    
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
  
 
</div>
<!-- ./wrapper -->

<!-- jQuery -->
<script src="/plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- DataTables  & Plugins -->
<script src="/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
<script src="/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
<script src="/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
<script src="/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
<script src="/plugins/jszip/jszip.min.js"></script>
<script src="/plugins/pdfmake/pdfmake.min.js"></script>
<script src="/plugins/pdfmake/vfs_fonts.js"></script>
<script src="/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
<script src="/plugins/datatables-buttons/js/buttons.print.min.js"></script>
<script src="/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>

<!-- Dependencies for excell export -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script> 

<!-- XLSX -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>


<!-- AdminLTE App -->
<script src="/dist/js/adminlte.min.js"></script>

<!-- SweetAlert2 -->
<script src="/plugins/sweetalert2/sweetalert2.min.js"></script>
<!-- Toastr -->
<script src="/plugins/toastr/toastr.min.js"></script>

<script>
  //-------------------DELETE REPORTS ----------------------------

$(document).ready(function () {
  attachEventHandlers();

  function attachEventHandlers() {
    // Use event delegation for dynamically loaded elements
    $(document).on("click", ".deleteButton", attachDeleteButtonClickHandler);
  }

  // Delete Button Handler for (Patients)
  function attachDeleteButtonClickHandler(e) {
    e.preventDefault();

    const form = $(this).closest("form");
    const date = form.find('input[name="date"]').val();

    Swal.fire({
      title: 'Are you sure?',
      text: "This action cannot be undone",
      icon: "warning",
      confirmButtonColor: "#12be12c1",
      showCancelButton: true,
      confirmButtonText: "Yes",
      cancelButtonColor: "#FF0000",
      cancelButtonText: "Cancel",
      customClass: {
        popup: "glassmorphism-popup",
      },
    }).then((result) => {
      if (result.isConfirmed) {
        form.submit();
      }
    });
  }
});

</script>

<!-- Page specific script -->
<script>

$(document).ready(function() {
    // Initialize DataTable with all options
    var table = $("#approvedPatientsTable").DataTable({
        "lengthChange": true,
        "autoWidth": false,
        "searching": true,
        "ordering": false,
        "destroy": true,
        "pageLength": 25,
        "processing": true,
    });

    function createExcelStyles() {
        return {
            headerStyle: {
                font: {
                    name: 'Arial',
                    bold: true,
                    sz: 12,
                    color: { rgb: "FFFFFF" }
                },
                fill: {
                    fgColor: { rgb: "344E41" }  // Matching your table header color
                },
                alignment: {
                    horizontal: "center",
                    vertical: "center",
                    wrapText: true
                },
                border: {
                    top: { style: "medium", color: { rgb: "000000" } },
                    bottom: { style: "medium", color: { rgb: "000000" } },
                    left: { style: "medium", color: { rgb: "000000" } },
                    right: { style: "medium", color: { rgb: "000000" } }
                }
            },
            subHeaderStyle: {
                font: {
                    name: 'Arial',
                    bold: true,
                    sz: 11,
                    color: { rgb: "FFFFFF" }
                },
                fill: {
                    fgColor: { rgb: "344E41" }
                },
                alignment: {
                    horizontal: "center",
                    vertical: "center"
                },
                border: {
                    top: { style: "thin", color: { rgb: "000000" } },
                    bottom: { style: "thin", color: { rgb: "000000" } },
                    left: { style: "thin", color: { rgb: "000000" } },
                    right: { style: "thin", color: { rgb: "000000" } }
                }
            },
            dataStyle: {
                font: {
                    name: 'Arial',
                    sz: 10
                },
                alignment: {
                    horizontal: "center",
                    vertical: "center"
                },
                border: {
                    top: { style: "thin", color: { rgb: "D3D3D3" } },
                    bottom: { style: "thin", color: { rgb: "D3D3D3" } },
                    left: { style: "thin", color: { rgb: "D3D3D3" } },
                    right: { style: "thin", color: { rgb: "D3D3D3" } }
                }
            }
        };
    }

    function exportToExcel() {
        const styles = createExcelStyles();
        
        // Define headers
           // Define headers
const headers = [
    ["BARANGAY", "DATE", "ELIGIBLE POPULATION", "BCG", "", "HEPATITIS B", "", "PENTAVALENT VACCINE 1", "", 
     "PENTAVALENT VACCINE 2", "", "PENTAVALENT VACCINE 3", "", 
     "OPV 1", "", "OPV 2", "", "OPV 3", "", "IPV", "", 
     "PCV1", "", "PCV2", "", "PCV3", "", "MMR1", "", "MMR2", "", "FIC", "", "CIC", ""],
    ["", "", "", "Male", "Female", "Male", "Female", "Male", "Female", 
     "Male", "Female", "Male", "Female", "Male", "Female", 
     "Male", "Female", "Male", "Female", "Male", "Female", 
     "Male", "Female", "Male", "Female", "Male", "Female", 
     "Male", "Female", "Male", "Female", "Male", "Female",
     "Male", "Female"]
];

// Get data from DataTable
const data = [];
data.push(...headers);

table.rows({ search: 'applied' }).every(function(rowIdx) {
    const rowData = this.data();
    const row = Array.from(rowData);
    data.push(row);
});

// Create workbook and worksheet
const wb = XLSX.utils.book_new();
const ws = XLSX.utils.aoa_to_sheet(data, { cellStyles: true });

// Maintain your original column widths
ws["!cols"] = [
    { wch: 15 },  // BARANGAY
    { wch: 20 },  // DATE
    { wch: 20 },  // Eligible Population
    { wch: 8 },   // BCG Male
    { wch: 8 },   // BCG Female
    { wch: 10 },  // Hepatitis B Male
    { wch: 10 },  // Hepatitis B Female
    { wch: 15 },  // Pentavalent Vaccine 1 Male
    { wch: 15 },  // Pentavalent Vaccine 1 Female
    { wch: 15 },  // Pentavalent Vaccine 2 Male
    { wch: 15 },  // Pentavalent Vaccine 2 Female
    { wch: 15 },  // Pentavalent Vaccine 3 Male
    { wch: 15 },  // Pentavalent Vaccine 3 Female
    { wch: 8 },   // OPV 1 Male
    { wch: 8 },   // OPV 1 Female
    { wch: 8 },   // OPV 2 Male
    { wch: 8 },   // OPV 2 Female
    { wch: 8 },   // OPV 3 Male
    { wch: 8 },   // OPV 3 Female
    { wch: 8 },   // IPV Male
    { wch: 8 },   // IPV Female
    { wch: 8 },   // PCV1 Male
    { wch: 8 },   // PCV1 Female
    { wch: 8 },   // PCV2 Male
    { wch: 8 },   // PCV2 Female
    { wch: 8 },   // PCV3 Male
    { wch: 8 },   // PCV3 Female
    { wch: 8 },   // MMR1 Male
    { wch: 8 },   // MMR1 Female
    { wch: 8 },   // MMR2 Male
    { wch: 8 },   // MMR2 Female
    { wch: 8 },   // FIC Male
    { wch: 8 },   // FIC Female
    { wch: 8 },   // CIC Male
    { wch: 8 }    // CIC Female
];

// Define row heights
ws['!rows'] = [
    { hpt: 35 },  // First row height
    { hpt: 25 }   // Second row height
];

// Apply styles to cells
for (let R = 0; R < data.length; R++) {
    for (let C = 0; C < data[R].length; C++) {
        const cellRef = XLSX.utils.encode_cell({ r: R, c: C });
        if (!ws[cellRef]) ws[cellRef] = { v: '', t: 's' };

        // Apply appropriate style based on row
        if (R === 0) {
            ws[cellRef].s = styles.headerStyle;
        } else if (R === 1) {
            ws[cellRef].s = styles.subHeaderStyle;
        } else {
            ws[cellRef].s = styles.dataStyle;
        }
    }
}

// Define merged cells
ws['!merges'] = [
    { s: { r: 0, c: 0 }, e: { r: 1, c: 0 } },  // BARANGAY
    { s: { r: 0, c: 1 }, e: { r: 1, c: 1 } },  // DATE
    { s: { r: 0, c: 2 }, e: { r: 1, c: 2 } },  // Eligible Population
    { s: { r: 0, c: 3 }, e: { r: 0, c: 4 } },  // BCG
    { s: { r: 0, c: 5 }, e: { r: 0, c: 6 } },  // HEPATITIS B
    { s: { r: 0, c: 7 }, e: { r: 0, c: 8 } },  // PENTA 1
    { s: { r: 0, c: 9 }, e: { r: 0, c: 10 } }, // PENTA 2
    { s: { r: 0, c: 11 }, e: { r: 0, c: 12 } }, // PENTA 3
    { s: { r: 0, c: 13 }, e: { r: 0, c: 14 } }, // OPV 1
    { s: { r: 0, c: 15 }, e: { r: 0, c: 16 } }, // OPV 2
    { s: { r: 0, c: 17 }, e: { r: 0, c: 18 } }, // OPV 3
    { s: { r: 0, c: 19 }, e: { r: 0, c: 20 } }, // IPV
    { s: { r: 0, c: 21 }, e: { r: 0, c: 22 } }, // PCV1
    { s: { r: 0, c: 23 }, e: { r: 0, c: 24 } }, // PCV2
    { s: { r: 0, c: 25 }, e: { r: 0, c: 26 } }, // PCV3
    { s: { r: 0, c: 27 }, e: { r: 0, c: 28 } }, // MMR1
    { s: { r: 0, c: 29 }, e: { r: 0, c: 30 } }, // MMR2
    { s: { r: 0, c: 31 }, e: { r: 0, c: 32 } }, // FIC
    { s: { r: 0, c: 33 }, e: { r: 0, c: 34 } }  // CIC
];



        // Add worksheet to workbook
        XLSX.utils.book_append_sheet(wb, ws, "Vaccine Report");

        // Write file with error handling
        try {
            XLSX.writeFile(wb, `vaccine_report_${new Date().toISOString().slice(0,10)}.xlsx`, {
                bookType: 'xlsx',
                bookSST: false,
                type: 'binary',
                cellStyles: true,
                compression: true
            });
        } catch (error) {
            console.error("Excel Export Error:", error);
            alert("Failed to generate Excel file. Please try again.");
        }
    }

    // Attach export function to button
    $('#exportExcelButton').on('click', exportToExcel);
});


  </script>




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<script>
  function logout() {
    Swal.fire({
        title: 'Are you sure?',
        text: "You will be logged out of your account.",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: "Yes",
        confirmButtonColor: "#12be12c1",
        cancelButtonText: "Cancel",
        cancelButtonColor: "#FF0000",
        customClass: {
        popup: 'glassmorphism-popup'
      }
    }).then((result) => {
        if (result.isConfirmed) {
            // Redirect to logout route or perform logout operation
            window.location.href = '/logout';  // Adjust the URL as needed
        }
    });
}

</script>


<script src="/preloader.js"></script>

</body>
</html>



