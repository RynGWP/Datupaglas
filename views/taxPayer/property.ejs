<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AdminLTE 3 | Dashboard</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- Tempusdominus Bootstrap 4 -->
  <link rel="stylesheet" href="/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
  <!-- iCheck -->
  <link rel="stylesheet" href="/plugins/icheck-bootstrap/icheck-bootstrap.min.css">
  <!-- JQVMap -->
  <link rel="stylesheet" href="/plugins/jqvmap/jqvmap.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/adminlte.min.css">
  <!-- overlayScrollbars -->
  <link rel="stylesheet" href="/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
  <!-- Daterange picker -->
  <link rel="stylesheet" href="/plugins/daterangepicker/daterangepicker.css">
  <!-- summernote -->
  <link rel="stylesheet" href="/plugins/summernote/summernote-bs4.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css">
  <link rel="stylesheet" href="style2.css">
  <style>

    .content {
      background: #f8f9fa;
      padding: 2rem;
    }
   
    .table {
      background: white;
      border: 1px solid #dee2e6;
    }
    th {
      background: #ffffff2b;
      color: rgb(0, 0, 0);
      text-align: left;
      padding: 0.75rem;
    }
    td {
      padding: 0.75rem;
    }
    .fw-bold {
      font-weight: bold;
    }
    .text-muted {
      color: #6c757d;
    }

    .list-group-item{
    border:none;
  }
    
    .nav-icon {
      color:rgb(58, 59, 66);
    }
    
    p {
      color:rgb(119, 119, 134);
    }
    
    
    .nav-link.active{
      background-color: rgba(127, 127, 189, 0.338) !important;
    }
    
    
  .brand-link{
    border-bottom: none !important;
  }


  td{
    color:rgba(0, 0, 0, 0.596) !important;
  }

  th{
    font-weight: 400 !important ;
    color:black; 
  }

  </style>
  
</head>
<body class="hold-transition sidebar-mini layout-fixed">

<div class="wrapper">

  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand  navbar-light" >
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link text-light" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
      <!-- <li class="nav-item d-none d-sm-inline-block">
        <a href="index3.html" class="nav-link text-light">Home</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="#" class="nav-link">Contact</a>
      </li> -->
    </ul>

    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <!-- Navbar Search -->
      <!-- <button type="button" class="btn dropdown-toggle dropdown-icon text-light" data-toggle="dropdown" aria-expanded="false">
       Assessor <i class="fas fa-user"></i>
      </button> -->
    
      <%- include('../partials/profile.ejs') %>

    </ul>
  </nav>
  <!-- /.navbar -->

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="index3.html" class="brand-link" 
    style="background-color: #ffffff;
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(4px) saturate(180%);
  -webkit-backdrop-filter: blur(2px) saturate(180%);
    ">
      <img src="/images/Seal_of_Datu_Paglas.png" alt="AdminLTE Logo" class="brand-image img-circle " style="opacity: .8">
      <small class="brand-text font-weight-bold text-dark"> DATU PAGLAS</small> 
    </a> 

    <!-- Sidebar -->
    <div class="sidebar" style="background-color: #ffffff;
    box-shadow: 0 4px 30px rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(4px) saturate(180%);
  -webkit-backdrop-filter: blur(2px) saturate(180%);
    ">




      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
               <li class="nav-item ">
                <a href="/Dashboard" class="nav-link ">
                  <i class="nav-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class=" bi bi-house" viewBox="0 0 16 16">
                    <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
                  </svg></i>
                  <p>
                    Dashboard   
                  </p>
                </a>
               
              <li class="nav-item">
                <a href="/Profile" class="nav-link ">
                  <i class="nav-icon "><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
                    <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
                  </svg></i>
                  <p>
                    Profile
         
                  </p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/property" class="nav-link active">
                  <i class="nav-icon "><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-buildings" viewBox="0 0 16 16">
                    <path d="M14.763.075A.5.5 0 0 1 15 .5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V14h-1v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V10a.5.5 0 0 1 .342-.474L6 7.64V4.5a.5.5 0 0 1 .276-.447l8-4a.5.5 0 0 1 .487.022M6 8.694 1 10.36V15h5zM7 15h2v-1.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5V15h2V1.309l-7 3.5z"/>
                    <path d="M2 11h1v1H2zm2 0h1v1H4zm-2 2h1v1H2zm2 0h1v1H4zm4-4h1v1H8zm2 0h1v1h-1zm-2 2h1v1H8zm2 0h1v1h-1zm2-2h1v1h-1zm0 2h1v1h-1zM8 7h1v1H8zm2 0h1v1h-1zm2 0h1v1h-1zM8 5h1v1H8zm2 0h1v1h-1zm2 0h1v1h-1zm0-2h1v1h-1z"/>
                  </svg></i>
                  <p>
                    Property
                  </p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/documents" class="nav-link ">
                  <i class="nav-icon "> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-text" viewBox="0 0 16 16">
                    <path d="M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5m0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5"/>
                    <path d="M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"/>
                  </svg></i>
                  <p>
                    Documents
                  </p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/paymentHistoryForTaxPayer" class="nav-link ">
                  <i class="nav-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class=" bi bi-cash-coin" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M11 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8m5-4a5 5 0 1 1-10 0 5 5 0 0 1 10 0"/>
                    <path d="M9.438 11.944c.047.596.518 1.06 1.363 1.116v.44h.375v-.443c.875-.061 1.386-.529 1.386-1.207 0-.618-.39-.936-1.09-1.1l-.296-.07v-1.2c.376.043.614.248.671.532h.658c-.047-.575-.54-1.024-1.329-1.073V8.5h-.375v.45c-.747.073-1.255.522-1.255 1.158 0 .562.378.92 1.007 1.066l.248.061v1.272c-.384-.058-.639-.27-.696-.563h-.668zm1.36-1.354c-.369-.085-.569-.26-.569-.522 0-.294.216-.514.572-.578v1.1zm.432.746c.449.104.655.272.655.569 0 .339-.257.571-.709.614v-1.195z"/>
                    <path d="M1 0a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h4.083q.088-.517.258-1H3a2 2 0 0 0-2-2V3a2 2 0 0 0 2-2h10a2 2 0 0 0 2 2v3.528c.38.34.717.728 1 1.154V1a1 1 0 0 0-1-1z"/>
                    <path d="M9.998 5.083 10 5a2 2 0 1 0-3.132 1.65 6 6 0 0 1 3.13-1.567"/>
                  </svg></i>
                  <p>
                    Payment History
                  </p>
                </a>
              </li>

        </ul>
        
      </nav>
      <!-- /.sidebar-menu -->
    </div>
    <!-- /.sidebar -->
  </aside>
   <!-- preloader -->
   <%- include('../partials/preloader_v2.ejs') %>
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0">Property</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <!-- <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Dashboard v1</li> -->
            </ol>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

 
    
    <section class="content" id="content">
      <div class="container-fluid">
        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Property Information</h3>
              </div>
              <div class="card-body">
                <% if (locals.properties) { %>
                  <table id="propertyTable" class="table  ">
                    <thead>
                      <tr>
                        <th>Property ID</th>
                        <th>Property Location</th>
                        <th>Property Type</th>
                        <th>Area </th>
                        <th>Unit Value</th>
                        <th>Assessment Rate</th>
                        <th>Classification</th>
                        <th>Status</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% properties.forEach(property => { %>
                        <tr>
                          <td class="text-center"><%= property.property_id %></td>
                          <td><%= property.property_location %></td>
                          <td><%= property.property_type %></td>
                          <td><%= property.area %></td>
                          <td>â‚± <%= parseFloat(property.unit_value).toLocaleString() %></td>
                          <td><%= property.assessment_rate %>%</td>
                          <td><%= property.classification %></td>
                          <td>
                            <span class="badge badge-<%= property.occupancy_status === 'Occupied' ? 'success' : 'warning' %>">
                              <%= property.occupancy_status %>
                            </span>
                          </td>

                         <td>
                          <div class="d-flex align-items-center">                                      
                          <!-- Edit Property Button -->
                          <button type="button" class="btn viewPropertyButton" 
                          data-toggle="modal" 
                          data-target="#viewPropertyModal"
                          data-property-id="<%= property.property_id %>"
                          data-taxpayer-id="<%= property.taxpayer_id %>"
                          data-property-type="<%= property.property_type %>"
                          data-tax-declaration="<%= property.tax_declaration %>"
                          data-property-index="<%= property.property_index %>"
                          data-certificate-title="<%= property.certificate_title %>"
                          data-cadastral-lot="<%= property.cadastral_lot %>"
                          data-lot-no="<%= property.lot_no %>"
                          data-block-no="<%= property.block_no %>"
                          data-kind="<%= property.kind %>"
                          data-unit-value="<%= property.unit_value %>"
                          data-adjustment="<%= property.adjustment %>"
                          data-assessment-rate="<%= property.assessment_rate %>"
                          data-north="<%= property.north %>"
                          data-south="<%= property.south %>"
                          data-east="<%= property.east %>"
                          data-west="<%= property.west %>"
                          data-last-assessment-date="<%= property.last_assessment_date.toISOString() %>"
                          data-next-assessment-date="<%= property.next_assessment_date.toISOString() %>"
                          data-market-value="<%= property.market_value %>"
                          data-ownership-type="<%= property.ownership_type %>"
                          data-property-location="<%= property.property_location %>"
                          data-property-use="<%= property.property_use %>"
                          data-occupancy-status="<%= property.occupancy_status %>"
                          data-classification="<%= property.classification %>"
                          data-area="<%= property.area %>"
                          style="background: transparent; border: none; color: blue;">
                          <i class="fa-regular fa-lg fa-eye"> </i>
                  </button>
                </td>
                        </tr>
                      <% }) %>
                    </tbody>
                  </table>
                <% } else { %>
                  <div class="alert alert-info">
                    No properties found for this taxpayer.
                  </div>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>
    
    
    </section>
    
    <script>
    $(document).ready(function() {
      $('#propertyTable').DataTable({
        "responsive": true,
        "lengthChange": false,
        "autoWidth": false,
        "buttons": ["copy", "csv", "excel", "pdf", "print"]
      }).buttons().container().appendTo('#propertyTable_wrapper .col-md-6:eq(0)');
    });
    
   
    </script>
    
   
    
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const viewPropertyButtons = document.querySelectorAll('.viewPropertyButton');
      
        viewPropertyButtons.forEach(button => {
          button.addEventListener('click', function() {
            const dataset = this.dataset;
      
            // Populate modal fields
            document.getElementById('propertyTypeView').textContent = dataset.propertyType;
            document.getElementById('taxDeclarationView').textContent = dataset.taxDeclaration;
            document.getElementById('propertyIndexView').textContent = dataset.propertyIndex;
            document.getElementById('certificateTitleView').textContent = dataset.certificateTitle;
            document.getElementById('cadastralLotView').textContent = dataset.cadastralLot;
            document.getElementById('lotNoView').textContent = dataset.lotNo;
            document.getElementById('blockNoView').textContent = dataset.blockNo;
            document.getElementById('kindView').textContent = dataset.kind;
            document.getElementById('unitValueView').textContent = dataset.unitValue;
            document.getElementById('adjustmentView').textContent = dataset.adjustment;
            document.getElementById('assessmentRateView').textContent = dataset.assessmentRate;
            document.getElementById('marketValueView').textContent = dataset.marketValue;
            document.getElementById('ownershipTypeView').textContent = dataset.ownershipType;
            document.getElementById('propertyLocationView').textContent = dataset.propertyLocation;
            document.getElementById('propertyUseView').textContent = dataset.propertyUse;
            document.getElementById('occupancyStatusView').textContent = dataset.occupancyStatus;
            document.getElementById('classificationView').textContent = dataset.classification;
            document.getElementById('areaView').textContent = dataset.area;
            document.getElementById('northView').textContent = dataset.north;
            document.getElementById('southView').textContent = dataset.south;
            document.getElementById('eastView').textContent = dataset.east;
            document.getElementById('westView').textContent = dataset.west;
      
            // Format and set date fields
            document.getElementById('lastAssessmentDateView').textContent = new Date(dataset.lastAssessmentDate).toLocaleDateString();
            document.getElementById('nextAssessmentDateView').textContent = new Date(dataset.nextAssessmentDate).toLocaleDateString();
          });
        });
      });
      </script>



  <!-- for view modal -->
<div class="modal fade" id="viewPropertyModal" tabindex="-1" role="dialog" aria-labelledby="viewPropertyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="viewPropertyModalLabel">View Property Details</h5>
        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body p-3">
        <div class="row">
          <!-- Property Type -->
          <div class="col-md-6 mb-3">
            <p><strong>Property Type:</strong> <span id="propertyTypeView"></span></p>
          </div>
          <!-- Tax Declaration -->
          <div class="col-md-6 mb-3">
            <p><strong>Tax Declaration:</strong> <span id="taxDeclarationView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Property Index -->
          <div class="col-md-6 mb-3">
            <p><strong>Property Index:</strong> <span id="propertyIndexView"></span></p>
          </div>
          <!-- Certificate Title -->
          <div class="col-md-6 mb-3">
            <p><strong>Certificate Title:</strong> <span id="certificateTitleView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Cadastral Lot -->
          <div class="col-md-6 mb-3">
            <p><strong>Cadastral Lot:</strong> <span id="cadastralLotView"></span></p>
          </div>
          <!-- Lot No -->
          <div class="col-md-6 mb-3">
            <p><strong>Lot No:</strong> <span id="lotNoView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Block No -->
          <div class="col-md-6 mb-3">
            <p><strong>Block No:</strong> <span id="blockNoView"></span></p>
          </div>
          <!-- Kind -->
          <div class="col-md-6 mb-3">
            <p><strong>Kind:</strong> <span id="kindView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Unit Value -->
          <div class="col-md-6 mb-3">
            <p><strong>Unit Value:</strong> <span id="unitValueView"></span></p>
          </div>
          <!-- Adjustment -->
          <div class="col-md-6 mb-3">
            <p><strong>Adjustment:</strong> <span id="adjustmentView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Assessment Rate -->
          <div class="col-md-6 mb-3">
            <p><strong>Assessment Rate:</strong> <span id="assessmentRateView"></span></p>
          </div>
          <!-- Market Value -->
          <div class="col-md-6 mb-3">
            <p><strong>Market Value:</strong> <span id="marketValueView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Ownership Type -->
          <div class="col-md-6 mb-3">
            <p><strong>Ownership Type:</strong> <span id="ownershipTypeView"></span></p>
          </div>
          <!-- Property Location -->
          <div class="col-md-6 mb-3">
            <p><strong>Property Location:</strong> <span id="propertyLocationView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Property Use -->
          <div class="col-md-6 mb-3">
            <p><strong>Property Use:</strong> <span id="propertyUseView"></span></p>
          </div>
          <!-- Occupancy Status -->
          <div class="col-md-6 mb-3">
            <p><strong>Occupancy Status:</strong> <span id="occupancyStatusView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Classification -->
          <div class="col-md-6 mb-3">
            <p><strong>Classification:</strong> <span id="classificationView"></span></p>
          </div>
          <!-- Area -->
          <div class="col-md-6 mb-3">
            <p><strong>Area:</strong> <span id="areaView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Directions -->
          <div class="col-md-3 mb-3">
            <p><strong>North:</strong> <span id="northView"></span></p>
          </div>
          <div class="col-md-3 mb-3">
            <p><strong>South:</strong> <span id="southView"></span></p>
          </div>
          <div class="col-md-3 mb-3">
            <p><strong>East:</strong> <span id="eastView"></span></p>
          </div>
          <div class="col-md-3 mb-3">
            <p><strong>West:</strong> <span id="westView"></span></p>
          </div>
        </div>
        <div class="row">
          <!-- Dates -->
          <div class="col-md-6 mb-3">
            <p><strong>Last Assessment Date:</strong> <span id="lastAssessmentDateView"></span></p>
          </div>
          <div class="col-md-6 mb-3">
            <p><strong>Next Assessment Date:</strong> <span id="nextAssessmentDateView"></span></p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- for view modal -->
  

  </div>
  <!-- /.content-wrapper -->
  <footer class="main-footer">
    <strong>Copyright &copy; 2014-2021 <a href="https://adminlte.io">AdminLTE.io</a>.</strong>
    All rights reserved.
    <div class="float-right d-none d-sm-inline-block">
      <b>Version</b> 3.2.0
    </div>
  </footer>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->

<!-- jQuery -->
<script src="/plugins/jquery/jquery.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="/plugins/jquery-ui/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
  $.widget.bridge('uibutton', $.ui.button)
</script>
<!-- Bootstrap 4 -->
<script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- AdminLTE App -->
<script src="dist/js/adminlte.js" defer></script>

<script src="/preloader.js"></script>

</body>
</html>
